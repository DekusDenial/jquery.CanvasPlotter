/*! jQuery Canvasplotter - v0.1.0 - 2012-04-15
* https://github.com/DekusDenial/jquery.CanvasPlotter
* Copyright (c) 2012 DekusDenial; Licensed MIT */
typeof Object.create!="function"&&(Object.create=function(a){function b(){}return b.prototype=a,new b}),function(a,b,c,d){var e={init:function(b,c){this.el=b,this.$el=a(b),this.config=a.extend({},a.fn.canvasPlotter.defaults,c),this.dataSource=this.$el.data("source")||this.config.dataSource,this.dataSource=this.dataSource.indexOf("#")>-1?this.dataSource:"#"+this.dataSource,this.fetchData()},fetchData:function(){this.xValue=[],this.yValue=[];var b=this,c=a(this.config.dataSource),d=c.find("th");this.xLabel=d[0],this.yLabel=d[1],c.find("tr td").each(function(a,c){a&1?b.yValue.push(c.innerText):b.xValue.push(c.innerText)}),this.prepareCanvas()},prepareCanvas:function(){this.$cv=this.$el.append("<canvas>").find("canvas"),this.$cv[0].height=this.config.canvasHeight,this.$cv[0].width=this.yValue.length*(this.config.barWidth+this.config.barGap)+this.config.barGap;if(!(this.cvContext=this.$cv[0].getContext("2d")))throw"Sorry, something wrong with canvas in your browser!";this.normalizeData(),this.drawLabels(),this.config.animated?this.animatedPlotBars():this.plotBars()},normalizeData:function(){this.maxValue=Math.max.apply(Math,this.yValue),this.minValue=Math.min.apply(Math,this.yValue)-Math.round(this.maxValue/10)},drawLabels:function(){var a,b=this.xValue.length,c=this.cvContext;c.save(),c.font="11px Helvetica, Arial, sans-serif",c.fillStyle="#000000";for(a=0;a<b;a++)c.fillText(this.xValue[a],this.utils.posX.call(this,a),this.config.constants.maxHeight+this.config.constants.xLabelOffset);c.restore()},plotBars:function(){},animatedPlotBars:function(){this.$cv.addClass("bar-animated")},utils:{posX:function(a){return a*this.config.barWidth+(a+1)*this.config.barGap},posY:function(a){return this.config.constants.maxHeight-this.scale(a)},scale:function(a){return Math.round(a/this.maxValue*this.config.constants.maxHeight)}}};a.fn.canvasPlotter=function(a){return this.each(function(){var b=Object.create(e);b.init(this,a)})},a.fn.canvasPlotter.defaults={animated:!1,dataSource:"table#dataSource",barGap:20,barWidth:25,canvasHeight:200,constants:{bottomOffset:20,xLabelOffset:15,yTickOffset:3,xTickOffset:3,scaleFactor:.1}},a.fn.canvasPlotter.defaults.constants.maxHeight=a.fn.canvasPlotter.defaults.canvasHeight-a.fn.canvasPlotter.defaults.constants.bottomOffset}(jQuery,window,document)